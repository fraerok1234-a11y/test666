@echo off
chcp 65001 >nul
echo ========================================
echo   –°–ë–û–†–ö–ê APK –î–õ–Ø ANDROID
echo ========================================
echo.

echo [1/4] –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ EAS CLI...
where eas >nul 2>&1
if %errorlevel% neq 0 (
    echo ‚ùå EAS CLI –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!
    echo.
    echo –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é EAS CLI...
    call npm install -g eas-cli
    if %errorlevel% neq 0 (
        echo ‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ EAS CLI
        pause
        exit /b 1
    )
    echo ‚úÖ EAS CLI —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
) else (
    echo ‚úÖ EAS CLI —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
)
echo.

echo [2/4] –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–∞ –≤ –∞–∫–∫–∞—É–Ω—Ç Expo...
eas whoami >nul 2>&1
if %errorlevel% neq 0 (
    echo ‚ö†Ô∏è  –í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –≤ Expo
    echo.
    echo –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç Expo:
    call eas login
    if %errorlevel% neq 0 (
        echo ‚ùå –û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞
        pause
        exit /b 1
    )
) else (
    echo ‚úÖ –í—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –≤ Expo
)
echo.

echo [3/4] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...
call npm install --legacy-peer-deps
if %errorlevel% neq 0 (
    echo ‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
    pause
    exit /b 1
)
echo ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
echo.

echo [4/4] –ó–∞–ø—É—Å–∫ —Å–±–æ—Ä–∫–∏ APK...
echo.
echo ‚ö†Ô∏è  –í–ê–ñ–ù–û:
echo    - –°–±–æ—Ä–∫–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ –æ–±–ª–∞–∫–µ Expo
echo    - –≠—Ç–æ –∑–∞–π–º–µ—Ç 10-20 –º–∏–Ω—É—Ç
echo    - –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è APK
echo    - APK –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ –ª—é–±–æ–π Android —Ç–µ–ª–µ—Ñ–æ–Ω
echo.
pause

call eas build --platform android --profile preview

if %errorlevel% equ 0 (
    echo.
    echo ========================================
    echo   ‚úÖ –°–ë–û–†–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê –£–°–ü–ï–®–ù–û!
    echo ========================================
    echo.
    echo üì± –ö–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å APK –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω:
    echo    1. –°–∫–∞—á–∞–π—Ç–µ APK –ø–æ —Å—Å—ã–ª–∫–µ –≤—ã—à–µ
    echo    2. –ü–µ—Ä–µ–¥–∞–π—Ç–µ —Ñ–∞–π–ª –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω (—á–µ—Ä–µ–∑ USB, email, –æ–±–ª–∞–∫–æ)
    echo    3. –ù–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Üí –†–∞–∑—Ä–µ—à–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É –∏–∑ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
    echo    4. –û—Ç–∫—Ä–æ–π—Ç–µ APK —Ñ–∞–π–ª –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ
    echo.
) else (
    echo.
    echo ========================================
    echo   ‚ùå –û–®–ò–ë–ö–ê –ü–†–ò –°–ë–û–†–ö–ï
    echo ========================================
    echo.
    echo –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –≤—ã—à–µ
    echo.
)

pause

